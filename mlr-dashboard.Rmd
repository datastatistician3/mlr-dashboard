---
title: "Machine Learning Models"
params:
output:
  flexdashboard::flex_dashboard:
    social: [ "menu" ]
    orientation: rows
    vertical_layout: fill
    source_code: embed
    theme: cerulean
# runtime: shiny
---

<!--  Set the working directory to the repository's base directory; this assumes the report is nested inside of three directories.-->
```{r, echo=F, message=F}
# cat("Working directory: ", getwd())
library(knitr)
library(flexdashboard)
library(shiny)
opts_knit$set(root.dir='../../../')  #Don't combine this call with any other chunk -especially one that uses file paths.
```

<!-- Set the report-wide options, and point to the external code file. -->
```{r set-options, echo=F}
# cat("Working directory: ", getwd())
report_render_start_time <- Sys.time()
opts_chunk$set(
  results      = 'show',
  comment      = NA,
  tidy         = FALSE,
  # dpi        = 400,
  # out.width  = "650px", #This affects only the markdown, not the underlying png file.  The height will be scaled appropriately.
  fig.width    = 4,
  fig.height   = 4,
  fig.path     = 'figure-dashboard-png/'
)

echo_chunks    <- FALSE #Toggle for debugging.
message_chunks <- FALSE #Toggle for debugging.
options(width=100) #So the output is 25% wider than the default.
```

<!-- Load 'sourced' R files.  Suppress the output when loading sources. -->
```{r load-sources, echo=echo_chunks, message=message_chunks}
```

<!-- Load packages, or at least verify they're available on the local machine.  Suppress the output when loading packages. -->
```{r load-packages, echo=echo_chunks, message=message_chunks}
```

<!-- Load any global functions and variables declared in the R file.  Suppress the output. -->
```{r declare-globals, echo=echo_chunks, results='show', message=message_chunks}
```

<!-- Declare any global functions specific to a Rmd output.  Suppress the output. -->
```{r rmd-specific, echo=echo_chunks, message=message_chunks}
```

<!-- Load the datasets.   -->
```{r load-data, echo=echo_chunks, results='show', message=message_chunks}
```

<!-- Tweak the datasets.   -->
```{r tweak-data, echo=echo_chunks, results='show', message=message_chunks}
```


# Summary
This dashboard helps facilitate the CQI analyses used in the MIECHV 3 project.

Sidebar {.sidebar data-width=245}
=======================================================================

```{r}
# Rate at which to flag high download traffic
sliderInput("rateThreshold", "Warn when rate exceeds:",
            min = 0, max = 50, value = 3, step = 0.1
)
# Maximum number of raw data rows to keep
numericInput("maxrows", "Recent downloads window:", 50)
```

## Overall {.tabset data-width=300}

### Notes

1. The current report covers "r scales::comma(nrow(ds))" total weekly records for "r dplyr::n_distinct(ds"program_code)" unique programs and "r dplyr::n_distinct(ds"model_name)" unique models ("r paste(sort(unique(ds"model_name)), collapse=", ")").
1. The dates range from "r min(ds"week, na.rm=T)" to  "r max(ds"week, na.rm=T)" (*i.e.*, "r dplyr::n_distinct(ds"week)" weeks).
1. The selected program is "r program_focus".

## Headline Graph  {.tabset}

### Headline Graph
```{r headline-graph, echo=echo_chunks, message=message_chunks}
```

# Spaghetti 

## {.tabset}

<!-- fig dimensions are ignored in flexdashboard -->
```{r spaghetti, echo=echo_chunks, message=message_chunks, results='asis', fig.height=8, fig.width=20}
```

# Tables

## {.tabset}

### Program by Week
```{r program-by-week-provider, echo=echo_chunks, message=message_chunks}



```


Summary Graphs
=============================================

## Marginals {.tabset storyboard}

```{r marginals, echo=echo_chunks, message=message_chunks, results='asis'}
```

# Documentation

## {.tabset}

### Explanation - Current PDSA

1. Measures

    * **Outcome**: Tracking goal progress reported on the Encounter Form and Goal Plan Form in ETO
        * **Numerator**: Numberof PDSA3/HOPE goals where progress (“started”, “partially completed”, or “completed”) has occurred.
        * **Denominator**: Total number of actively pursued, PDSA3/HOPE goals

    * **Process**: Submit goal status in the Goal Plan Form: Abandoned, Not Started, Started, Partially Completed, and Completed. 
        * **Numerator**: Weekly discussions towards PDSA3/HOPE goals
        * **Denominator**: Total number of actively pursued, PDSA3/HOPE goals
    
    * **Disruptor**: Not able to establish the goal (families without an active goal)
        * **Numerator**: Number of clients that have not established goals
        * **Denominator**: Total number of goals (sum of discussed and not discussed)

2. A program's weekly values are plotted on top of the background of other programs in the model.

3. Each graph represents one outcome. 

#### Resources

[Link to Current PDSA Document in Google Drive](https://docs.google.com/document/d/1A8sSklKjF3-1stEkRMFxpRYN2K7TrsFY7q-j9OusXB4/edit)

### Explanation -All CQI Dashboards

















